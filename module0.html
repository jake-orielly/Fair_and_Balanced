<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" type="text/css" href="mainStyle.css">
    <link rel="stylesheet" type="text/css" href="elementStyle.css">
</head>
<style>
    h1 {
        text-decoration: underline;
    }
    table {
        padding-left: 10px;
    }
    
    td {
        font-size: 18px;
        margin-bottom: 10px;
        margin-right: 5px;
        float:left;
    }
    
    button {
        background-color:#FFFFFF;
        -moz-border-radius:5px;
        -webkit-border-radius:5px;
        border-radius:5px;
        font-family:Arial;
        font-size:12px;
        padding:3px 6px;
        color:#000000;
    }
    
    .statBar {
        margin-top: 2px;
        width:6px;
        height:14px;
        border:2px solid #000;
        float:left; 
        margin-left:1px
    }
    
    ul.tab {
        list-style-type: none;
        margin: 0;
        padding: 0;
        overflow: hidden;
        border: 1px solid #ccc;
        background-color: #f1f1f1;
    }
    /* Float the list items side by side */
    ul.tab li {float: left;}
    /* Style the links inside the list items */
    ul.tab li a {
        display: inline-block;
        color: black;
        text-align: center;
        padding: 14px 16px;
        text-decoration: none;
        font-size: 17px;
    }
    /* Change background color of links on hover */
    ul.tab li a:hover {
        background-color: #ddd;
    }
    /* Create an active/current tabLink class */
    ul.tab li a:focus, .active {
        background-color: #ccc;
    }
    /* Style the tab content */
    .tabContent {
        display: none;
        padding: 6px 12px;
        border: 1px solid #ccc;
        border-top: none;
    }
    
    #newsroomHeader{
        margin-left: 7%;
        margin-bottom: 0px;
        font-family:Futura, "Trebuchet MS", Arial, sans-serif;
        font-style: italic;
        font-size: 48px;
        text-decoration: underline;
    }
</style>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
<body>
    <img src="art/logo.png" style="float:left; width: 64px; height:64px;" alt="error loading image">
    <p id="newsroomHeader"> Channel 5 Newsroom </p>
    <br>
    <ul class="tab">
        <li><a href="javascript:void(0)" class="tabLinks active" onclick="openTab(event, 'Board')">Board</a></li>
        <li><a href="javascript:void(0)" class="tabLinks" onclick="openTab(event, 'Broadcast')">Broadcast</a></li>
        <li><a href="javascript:void(0)" class="tabLinks" onclick="openTab(event, 'Anchors')">Anchors</a></li>
    </ul>
    
    <div id='Board' class = 'tabContent'>
        <h1> Board </h1>
        <table id="statsTable">
        </table>
    </div>
    
    <div id='Broadcast' class = 'tabContent'>
        <table class="storyPlanning" id="storyTable" style="float: right; display:inline; text-align:right" hidden><th><h1 class="storyPlanning" hidden>Broadcast </h1></th></table>
        <h1 id="broadcastHeader"> Advertising </h1>
        <input id="adRange" class="adTiming" type="range" min = "5" max="25">
        <p id="adValue" class="adTiming"> ERROR </p>
        <p id="newsValue" class="adTiming"> ERROR </p>
        <button class="adTiming" onclick="adTimingConfirm()"> Confirm </button>
        <p class="adPlanning" id="adAvailible" hidden> ERROR </p>
        <p class="adPlanning" id="adTotal" hidden> ERROR </p>
        <button class="adPlanning" id="adChosenConfirm" onclick="toStoryMode()" hidden> Confirm </button>
        <button class="adPlanning" id="backButton" onclick="adBack()" hidden> Back </button>
        <p class="adPlanning" id="adRevenue" hidden> Total Revenue: $0 </p>
        <table class="adPlanning" id="advertisingTable" style="margin-top:15px" hidden>
        </table>
    </div>
    
    <div id='Anchors' class = 'tabContent'>
        <h1> Anchors </h1>
        <img src="art/anchor1.png" style="float:left" alt="error loading image">
        <table id="anchorTable">
        </table>
    </div>
    
    <div id="dialogueBox" class="contract" hidden>
        <img id="portrait" src="art/anchor1.png" alt="error loading image">
        <img id="dialogueBoxImage" src="art/dialogueBox.png" alt="error loading image" style="width:304px;height:138px;">
      
        <p class = "scrollText" id="demo"></p>
    </div>
    
    <script>
        //Note: party colors #009933 & #ff6600
        var linda = {name:"Linda",age:47, salary: 36500, tagline: "Loyal, experienced, and will always remember your birthday.", experience:7,attractiveness:3};
        var anchorList = [linda];
        
        var money = 100000;
        var viewers = 4500;
        
        var adRevenue = 0;
        var adTimeAvailible;
        var storyTimeAvailible;
        
        var story1 = {name:"Local Politics", effect:"none"};
        var story2 = {name:"National Politics", effect:"rep 5"};
        var story3 = {name:"Global Politics", effect:"none"};
        var story4 = {name:"Local Crime", effect:"none"};
        var stories = [story1,story2,story3];
        
        var chosenStories = [];
        
        var ad1 = {name:"Soca Cola", value:5000, image:"colaSoda.png", minutes:5};
        var ad2 = {name:"Pepsi", value:6000, image:"colaSoda.png", minutes:6};
        var ad3 = {name:"Guns", value:4000, image:"colaSoda.png",minutes:4};
        var ad4 = {name:"Cars", value:8000, image:"colaSoda.png",minutes:8};
        var ads = [ad1,ad2,ad3,ad4];
        
        startTab();
        displayStats();
        displayAdvertising();
        displayAnchors();
        
        var sliderLoop = setInterval(function() { sliderUpdate();}, 30);
        
        function startTab() {
            var tabLinks = document.getElementsByClassName("tabLinks");
            document.getElementById("Board").style.display = "block";
            tabLinks += " active";
        }    
        
        function displayStats() {
            var table = "<tr><td style='font-size:24px'>Money: " + numToDisplayNum(money,true) + "</td></tr>";
            table += "<tr><td style='font-size:24px'>Viewers: " + numToDisplayNum(viewers,false) + "</td></tr>";
            document.getElementById("statsTable").innerHTML = table;
        }
        
        function toStoryMode() {
            var sliderValue = document.getElementById("adRange").value;
            var timeAvailible = 60-parseInt(sliderValue);
            chosenStories = [];
            document.getElementById("adAvailible").innerHTML = "Availible " + timeAvailible + ":00";
            document.getElementById("adTotal").innerHTML = "Total: " + timeAvailible + ":00";
            storyTimeAvailible = 60 - adTimeAvailible;
            document.getElementById("backButton").onclick = function() {storyBackPress()};
            document.getElementById("broadcastHeader").innerHTML = "News Items";
            $("#adRevenue").hide();
            $("#adChosenConfirm").hide();
            $(".storyPlanning").show();
            displayStories();
        }
        
        function storyBackPress() {
            $(".adPlanning").show();
            $(".storyPlanning").hide();
            document.getElementById("broadcastHeader").innerHTML = "Advertising";
            adRevenue = 0;
            document.getElementById("backButton").onclick = function() {adBack()};
            updateAdAmounts();
            displayAdvertising();
        }
        
        function displayStories() {
            table = "";
            for (var i = 0; i < stories.length; i++) {
                table += "<tr>";
                table += "<td style='font-size:28px'>" + stories[i].name + "</td>";
                table += "<td><button id='addStory" + i + "' class='addButton' onclick='addStoryClick(" + i + ")'>Add</button></td>"
                table += "</tr>";
            }
            document.getElementById("advertisingTable").innerHTML = table;
        }
        
        function displayBroadcast() {
            table = "";
            table += "<th><h1 class='storyPlanning'> Broadcast </h1></th>"; 
            for (var i = 0; i < chosenStories.length; i++) {
                table += "<tr><td>" + chosenStories[i] + "</td></tr>";
            }
            document.getElementById("storyTable").innerHTML = table;
        }
        
        function displayAnchors() {
            var table = "<tr><td style='font-size:24px'><u><b>" + anchorList[0].name + ", " + anchorList[0].age + "</b></u></td></tr>";
            table += "<tr><td>Salary: " + numToDisplayNum(anchorList[0].salary,true) + "</td></tr>";
            table += "<tr><td>Experience: </td><td>";
            for (var i = 0; i < anchorList[0].experience; i++)
                table += "<div class='statBar' style='background:#006666'></div>";
            table += "</td></tr>"
            table += "<tr><td>Appearance: </td><td>";
            for (var i = 0; i < anchorList[0].attractiveness; i++)
                table += "<div class='statBar' style='background:#ff3300'></div>";
            table += "</td></tr>";
            table += "<tr><td><i>" + anchorList[0].tagline + "</i></td></tr>";
            
            document.getElementById("anchorTable").innerHTML = table;
        }
        
        function displayAdvertising() {
            var table = "";
            for (var i = 0; i < ads.length; i++) {
                table += "<tr>";
                table += "<td><img src='art/" + "colaSoda.png" + "' style='width:64px; height:32px; float:left' alt='error loading image'></td>";
                table += "<td style='margin-top:8px'>" + ads[i].name + ": " + numToDisplayNum(ads[i].value,true) + " for " + ads[i].minutes + " minutes." + "</td>";
                table += "<td><button id='adButton" + i + "' class='addButton' onclick='buyButtonClick(" + i + ")'>Add</button></td>"
                table += "</tr>";
            }
            document.getElementById("advertisingTable").innerHTML = table;
        }
        
        function openTab(evt, tabName) {
            var i, tabContent, tabLinks;
            tabContent = document.getElementsByClassName("tabContent");
            for (i = 0; i < tabContent.length; i++) {
                tabContent[i].style.display = "none";
            }
            tabLinks = document.getElementsByClassName("tabLinks");
            for (i = 0; i < tabLinks.length; i++) {
                tabLinks[i].className = tabLinks[i].className.replace(" active", "");
            }

            document.getElementById(tabName).style.display = "block";
            evt.currentTarget.className += " active";
        }    
        
        function buyButtonClick(given) {
            var button = document.getElementById("adButton" + given);
            if (adTimeAvailible - ads[given].minutes >= 0) {
                adTimeAvailible = adTimeAvailible - ads[given].minutes;
                button.className = "sellButton";
                button.innerHTML = "Remove";
                button.onclick = function(){sellButtonClick(given)};
                document.getElementById("adAvailible").innerHTML = "Availible " + adTimeAvailible + ":00";
                adRevenue += ads[given].value;
                document.getElementById("adRevenue").innerHTML = "Total Revenue: " + numToDisplayNum(adRevenue, true);
            }
            else {
                warningFlash("adAvailible");
            }
        }
        
        function addStoryClick(given) {
            var button = document.getElementById("addStory" + given);
            if (storyTimeAvailible - 20 >= 0) {
                storyTimeAvailible = storyTimeAvailible - 20;
                button.className = "sellButton";
                button.innerHTML = "Remove";
                button.onclick = function(){removeStoryClick(given)};
                document.getElementById("adAvailible").innerHTML = "Availible " + storyTimeAvailible + ":00";
                chosenStories[chosenStories.length] = stories[given].name;
                displayBroadcast();
            }
            else {
                warningFlash("adAvailible");
            }
        }
        
        function removeStoryClick(given) {
            var button = document.getElementById("addStory" + given);
            var index;
            button.className = "addButton";
            button.innerHTML = "Add";
            button.onclick = function(){addStoryClick(given)};
            storyTimeAvailible = storyTimeAvailible + 20;
            document.getElementById("adAvailible").innerHTML = "Availible " + storyTimeAvailible + ":00";
            index = chosenStories.indexOf(stories[given].name);
            if (index > -1) {
                chosenStories.splice(index, 1);
            }
            displayBroadcast();
        }
        
        function warningFlash(id) {
            var count = 0;
            var weight = document.getElementById(id).style.fontWeight;
            var flash = setInterval(function() {
                document.getElementById(id).style.fontWeight = "900";
                if (count % 2 == 0)
                    document.getElementById(id).style.color = "red";  
                else 
                    document.getElementById(id).style.color = "black";
                if (count == 11) {
                    clearInterval(flash);
                    document.getElementById(id).style.fontWeight = weight;
                }
                count++;
                },150)  ;
        }
        
        function sellButtonClick(given) {
            var button = document.getElementById("adButton" + given);
            button.className = "addButton";
            button.innerHTML = "Add";
            button.onclick = function(){buyButtonClick(given)};
            adTimeAvailible = adTimeAvailible + ads[given].minutes;
            document.getElementById("adAvailible").innerHTML = "Availible " + adTimeAvailible + ":00";
            adRevenue -= ads[given].value;
            document.getElementById("adRevenue").innerHTML = "Total Revenue: " + numToDisplayNum(adRevenue, true);
        }
        
        function adTimingConfirm() {
            $(".adTiming").hide();
            $(".adPlanning").show();
            updateAdAmounts();
        }
        
        function adBack() {
            $(".adTiming").show();
            $(".adPlanning").hide();
            var button;
            for (var i = 0; i < ads.length; i++) {
                button = document.getElementById("adButton" + i);
                if (button.innerHTML == "Remove")
                    sellButtonClick(i);
            }
        }
        
        function sliderUpdate() {
            var sliderValue = document.getElementById("adRange").value;
            document.getElementById("adValue").innerHTML = "Advertisements " + sliderValue + ":00";
            document.getElementById("newsValue").innerHTML = "News " + (60-sliderValue) + ":00";
        }
        
        function updateAdAmounts() {
            var sliderValue = document.getElementById("adRange").value;
            document.getElementById("adRevenue").innerHTML = "Total Revenue: " + numToDisplayNum(adRevenue, true);
            adTimeAvailible = sliderValue;
            document.getElementById("adAvailible").innerHTML = "Availible " + sliderValue + ":00";
            document.getElementById("adAvailible").style = "display:inline; margin-right:30px";
            document.getElementById("adTotal").innerHTML = "Total: " + sliderValue + ":00";
            document.getElementById("adTotal").style = "display:inline";
        }
        
        function numToDisplayNum(num, dollar) {
            var result;
            
            if (num > 999) {
                result = parseInt(num/1000) + "," + num%1000;
                result = longEnough(result); //ex: longEnough("10,0") = "10,000"
            }
            
            else 
                result = num;
            
            if (dollar)
                result = "$" + result;

            return result;
        }
        
        function longEnough(given) {
            if (given.split(",")[1].length < 3)
                return longEnough(given + "0");
            else 
                return given;
        }
    </script>
    
    <script src="textScroller.js">
        
    </script>
    
    <script src="contractText.js"></script>
</body>
</html>